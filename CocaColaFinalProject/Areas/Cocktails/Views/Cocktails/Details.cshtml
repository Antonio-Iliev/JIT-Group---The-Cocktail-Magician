@model CocktailViewModel

@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_LayoutCustom.cshtml";
}
<center><h1>@Model.Name details</h1></center>
<table class="table">
    <thead>
        <tr>
            <th><h5>Cocktail's Picture</h5></th>
            <th><h5>Cocktail's Details</h5></th>
            <th><h5>Cocktail's Ingredients</h5></th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><img src="@Model.Image" height="250" width="250" style="border-radius:25px; padding-top:5px; padding-bottom:5px"></td>
            <td>
                <h5>Name: @Model.Name</h5>
                <h5>Rating: @Model.Rating</h5>
            </td>
            <td>
                @foreach (var item in Model.CocktailIngredients)
                {
                    <h5>
                        @item.Ingredient.Name
                    </h5>
                }
            </td>
        </tr>
    </tbody>
</table>
<h1 class="hdr6"> Where to find "@Model.Name"</h1>
@if (Model.BarCocktails.Count() == 0)
{
    <h3 class="hdr3">
        you can be the first in the town to offer this cocktail
    </h3>
}
@foreach (var item in Model.BarCocktails)
{
    <div class="eventBox">
        <span class="date">SEP <span>06</span></span>
        <h4 class="hdr2">
            @item.Bar.Name<br>
            <span class="place"> @item.Bar.Address</span>
            <span class="time">11:00 am - 1:00 pm</span>
        </h4>
        <hr>
        <div class="clearfix"></div>
        <button style="background:none ; border:0px ; outline:0px ; padding-top:5px" id="map_cocktail" data-rel="prettyPhoto" class="mapit" value="@item.Bar.Address"><i></i>Map it </button>
        <a target="_blank" href="http://www.facebook.com/sharer/sharer.php?u=foodtruck.html.themeforest.createit.pl" class="shareit"><i></i>Share it</a>
    </div>
}
<center>
    <div style="padding-bottom:20px">
        <a asp-action="ListCocktails" class="btn btn-success">Back to List</a>
    </div>
</center>
<script>
    var geocoder;
    var map;

    function initialize() {

        let mapBtns = document.getElementsByClassName("mapit");

        for (const btn of mapBtns) {

            btn.addEventListener('click', (e) => {

                e.preventDefault();
                let currentBtn = e.currentTarget;

                var divForTheMap = document.createElement('div');
                divForTheMap.style.height = '360px';
                divForTheMap.style.width = '98vm';
                divForTheMap.id = 'divForTheMap' + e.currentTarget.value;
                divForTheMap.style.display = 'block';
                divForTheMap.style.position = 'relative';
                divForTheMap.style.overflow = 'hidden';
                console.log(divForTheMap);

                if (document.getElementById("divForTheMap" + e.currentTarget.value) != null) {
                    console.log("sega ima karta");
                    if (document.getElementById("divForTheMap" + e.currentTarget.value).style.display == "none") {
                        document.getElementById("divForTheMap" + e.currentTarget.value).setAttribute("style", "display:block");
                        document.getElementById("divForTheMap" + e.currentTarget.value).style.width = '98vm'
                        document.getElementById("divForTheMap" + e.currentTarget.value).style.height = '360px'
                        document.getElementById("divForTheMap" + e.currentTarget.value).style.display = 'block'
                        document.getElementById("divForTheMap" + e.currentTarget.value).style.position = 'relative'
                        document.getElementById("divForTheMap" + e.currentTarget.value).style.overflow = 'hidden'
                        currentBtn.innerHTML = "<i></i>HIDE Map";
                        console.log("invisible");
                    }
                    else {

                        console.log("visible");
                        document.getElementById("divForTheMap" + e.currentTarget.value).setAttribute("style", "display:none");
                        currentBtn.innerHTML = "<i></i>Map it";
                    }
                }
                else {
                    //var divForTheMap = document.createElement('div');
                    //divForTheMap.style.height = '360px';
                    //divForTheMap.style.width = '98vm';
                    //divForTheMap.id = 'divForTheMap' + e.currentTarget.value;
                    //divForTheMap.style.display = 'block';
                    //divForTheMap.style.position = 'relative';
                    //divForTheMap.style.overflow = 'hidden';

                    geocoder = new google.maps.Geocoder();
                    var latlng = new google.maps.LatLng(-34.397, 150.644);

                    var mapOptions = {
                        zoom: 8,
                        center: latlng
                    }
                    map = new google.maps.Map(divForTheMap, mapOptions);

                    //geolocator
                    var eventBox = e.currentTarget.parentElement;
                    eventBox.parentNode.insertBefore(divForTheMap, eventBox.nextSibling);

                    var address = e.currentTarget.value;
                    //console.log(address); //button
                    //console.log(e.currentTarget.value); //adress

                    geocoder.geocode({ 'address': address }, function (results, status) {
                        if (status == 'OK') {
                            map.setCenter(results[0].geometry.location);
                            var marker = new google.maps.Marker({
                                map: map,
                                position: results[0].geometry.location
                            });

                        } else {
                            alert('Geocode was not successful for the following reason: ' + status);
                        }
                    });

                    currentBtn.innerHTML = "<i></i>HIDE Map";
                }
            });
        }
    }
</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB2QJIfVlhWTpxgG5zCkx1XMmwADlMuE4c&callback=initialize">
</script>
